# تعامل با جاوا اسکریپت

تا به حال **معماری Elm**، **انواع داده**، **دستورات**، **اشتراک‌ها** را دیده‌ایم و Elm را روی سیستم خود نصب کرده‌ایم.

اما وقتی نیاز به کار با جاوا اسکریپت دارید، چه اتفاقی می‌افتد؟ شاید یک Browser API وجود داشته باشد که هنوز بسته‌ نرم‌افزاری معادل در Elm ندارد. شاید بخواهید یک ویجت جاوا اسکریپت را درون برنامه خود جاسازی کنید. این فصل سه مکانیزم تعامل با جاوا اسکریپت را معرفی می‌کند:

- [Flags](flags.md)
- [Ports](ports.md)
- [Custom Elements](custom_elements.md)

قبل از اینکه به این سه مکانیزم بپردازیم، باید بدانیم چگونه برنامه Elm را به جاوا اسکریپت کامپایل کنیم!

> **توجه:** اگر در حال ارزیابی Elm برای استفاده در محل کار هستید، توصیه می‌کنم اطمینان یابید که این سه مکانیزم قادر به پوشش تمام نیازهای شما باشند. می‌توانید با نگاهی به این [نمونه‌ها](https://github.com/elm-community/js-integration-examples/) یک مرور سریع از این فصل داشته باشید. لطفا اگر از چیزی اطمینان ندارید، [اینجا](https://discourse.elm-lang.org/) پرس و جو کنید و اگر به طور کامل اطمینان ندارید، توصیه می‌کنم بعدا به Elm برگردید.

## کامپایل به جاوا اسکریپت

با اجرای دستور `elm make`، به‌طور پیشفرض فایل HTML تولید می‌شود. بنابراین اگر بگویید:

```bash
elm make src/Main.elm
```

فایلی به نام `index.html` تولید می‌شود که می‌توانید آن را باز کرده و شروع به کار با آن کنید. اگر نیاز به تعامل با جاوا اسکریپت داشتید، می‌توانید به جای آن فایل جاوا اسکریپت تولید کنید:

```bash
elm make src/Main.elm --output=main.js
```

با اجرای این دستور، یک فایل جاوا اسکریپت تولید می‌شود که یک تابع `Elm.Main.init()` را در دسترس قرار می‌دهد. بنابراین وقتی `main.js` را دارید، می‌توانید فایل HTML را مطابق با نیاز خود سفارشی‌سازی کنید.

## جاسازی در HTML

در اینجا، یک قالب حداقلی HTML برای نمایش فایل `main.js` در مرورگر وب آمده است:

```html
<html>
<head>
  <meta charset="UTF-8">
  <title>Main</title>
  <script src="main.js"></script>
</head>

<body>
  <div id="myapp"></div>
  <script>
  var app = Elm.Main.init({
    node: document.getElementById('myapp')
  });
  </script>
</body>
</html>
```

می‌خواهم توجه شما را به خطوط مهم این قالب جلب کنم:

- `<head>` - یک خط برای بارگیری فایل کامپایل شده `main.js` داریم. این الزامی است! اگر یک ماژول به نام `Main` کامپایل کنید، یک تابع `Elm.Main.init()` در جاوا اسکریپت خواهید داشت. اگر یک ماژول به نام `Home` کامپایل کنید، یک تابع `Elm.Home.init()` در جاوا اسکریپت خواهید داشت.

- `<body>` - باید دو کار در اینجا انجام دهیم. اول، یک `<div>` ایجاد می‌کنیم که می‌خواهیم برنامه Elm بر آن تسلط یابد. شاید این درون یک برنامه بزرگتر باشد که با چیزهای دیگر احاطه شده است؟ اشکالی ندارد! دوم، یک `<script>` داریم تا برنامه Elm را راه‌اندازی کنیم. در اینجا تابع `Elm.Main.init()` را برای شروع برنامه فراخوانی می‌کنیم و `node` مورد نظر برای برنامه را پاس می‌دهیم.

اکنون که می‌دانیم چگونه برنامه Elm را در یک فایل HTML جاسازی کنیم، وقت آن است که به بررسی سه گزینه تعامل با جاوا اسکریپت بپردازیم: پرچم، پورت و عنصر سفارشی!

> **توجه:** این یک فایل عادی HTML است، بنابراین می‌توانید هر چیزی که می‌خواهید در آن قرار دهید! بسیاری از توسعه‌دهندگان فایل‌های CSS و JS اضافی را در `<head>` قرار می‌دهند. بنابراین، اشکالی ندارد که CSS را به‌صورت دستی بنویسید یا به نوعی آن را تولید کنید. چیزی مانند `<link rel="stylesheet" href="whatever-you-want.css">` را در `<head>` قرار دهید و به آن دسترسی پیدا کنید. (گزینه‌های دیگری برای تعریف CSS  _درون_ Elm وجود دارد، اما خارج از بحث ماست!)